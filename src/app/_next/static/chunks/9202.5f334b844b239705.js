(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9202],{29599:function(e,i,t){"use strict";t.d(i,{C:function(){return l}});var n=t(21535);let o=(e,i)=>{let t=n.env.ASSET_PREFIX||"";return"".concat(t,"/video/vibe_animation_fallback/vibe_animation_fallback_").concat(e,".").concat(i)},l=e=>({posterSrc:o(e,"jpeg"),videoSrc:o(e,"mp4")})},39202:function(e,i,t){"use strict";t.r(i),t.d(i,{VibeAnimation:function(){return C}});var n=t(65301),o=t(9695),l=t(96233),a=t(91207),s=t(55975),r=t(19489),d=t(91878),c=t(51304),u=t(86348),v=t(78671),m=t(56198),b=t(29599),k=t(44729),_=t(82036),f=t(81437),y=t(29778),p=t(98863),L=t.n(p);let M=(0,l.Pi)(e=>{let{closeToast:i}=e,{fullscreenPlayer:t}=(0,m.oR4)(),o=(0,a.useCallback)(()=>{t.modal.isOpened&&t.modal.close()},[t]),l=(0,a.useMemo)(()=>(0,n.jsxs)("div",{className:L().message,children:[(0,n.jsx)(f.Caption,{className:L().title,variant:"div",type:"controls",size:"m",children:(0,n.jsx)(k.Z,{id:"lite-version.notification-title"})}),(0,n.jsx)(y.rU,{className:L().link,href:"/settings",onClick:o,children:(0,n.jsx)(f.Caption,{className:L().linkText,variant:"div",type:"controls",size:"m",children:(0,n.jsx)(k.Z,{id:"lite-version.go-to-settings"})})})]}),[o]);return(0,n.jsx)(y.Yj,{cover:(0,n.jsx)(_.Icon,{className:L().icon,size:"xs",variant:"liteVersion"}),message:l,closeToast:i})}),A=new v.T6,E=e=>{let{renderer:i,fallback:t,isEnabled:o}=e,{notify:l}=(0,m.d$W)(),{settings:s}=(0,m.oR4)(),r=(0,a.useCallback)(e=>{if(!(e>=20)){if(!(null==i?void 0:i.isLiteAnimationEnabled)){null==i||i.enableLiteAnimationWithTransition();return}i.isFallbackEnabled||(i.enableFallbackWithTransition(),s.setLiteVersionMode(m.mNU.ENABLED,!0),l((0,n.jsx)(M,{}),{containerId:m.W$x.INFO,autoClose:!1}))}},[l,i,s]);(0,a.useEffect)(()=>{null==i||i.setFallback(t)},[t,i]),(0,a.useEffect)(()=>(!s.isLiteVersionModeAvailableForToggle&&o&&(null==i?void 0:i.isAnimationEnabled)?A.startMeasuring(r):A.stopMeasuring(),()=>{A.stopMeasuring()}),[r,o,null==i?void 0:i.isAnimationEnabled,s.isLiteVersionModeAvailableForToggle,s.liteVersionMode])},x=e=>{var i,t;let[n,o]=(0,a.useState)({}),{sonataState:l}=(0,m.oR4)();(0,a.useEffect)(()=>{if(l.contextType===r.A.Vibe){var i,t,a,s;n.id===(null===(i=l.entityMeta)||void 0===i?void 0:i.id)&&!n.isLiked&&(null===(s=l.entityMeta)||void 0===s?void 0:s.isLiked)&&e(),o({id:null===(t=l.entityMeta)||void 0===t?void 0:t.id,isLiked:null===(a=l.entityMeta)||void 0===a?void 0:a.isLiked})}},[l.contextType,null===(i=l.entityMeta)||void 0===i?void 0:i.id,null===(t=l.entityMeta)||void 0===t?void 0:t.isLiked,n.id,n.isLiked,e])};var T=t(28020),g=t.n(T);let N="vibe-animation",V=async()=>new Promise(e=>{setTimeout(()=>{e()},2e3)}),C=(0,l.Pi)(e=>{var i,t,l,k,_,f,y;let{className:p}=e,L=(0,a.useRef)(null),[M,A]=(0,d.z)(),{isIntersecting:T}=null!==(y=(0,c.S1)([L])[N])&&void 0!==y?y:{},{sonataState:C,user:I,settings:h,experiments:P}=(0,m.oR4)(),{theme:j}=(0,m.FgM)(),S=(0,m.wLl)(),F=(0,m.jpI)(),R=P.checkExperiment(m.peG.WebNextLiteVersion,"on"),B=C.status===u.Xz.PLAYING&&C.contextType===r.A.Vibe,U=(0,a.useCallback)(async e=>(e.classList.add(g().root_visible),V()),[]),w=(0,a.useCallback)(async e=>(e.classList.remove(g().root_visible),V()),[]),H=(0,a.useMemo)(()=>(0,b.C)(j),[j]);return E({renderer:M,fallback:H,isEnabled:R}),(0,a.useEffect)(()=>{var e,i;if(!L.current)return;let t=new v.dr({container:L.current,fallback:H,analyser:null==F?void 0:F.analyser,collectionHue:I.collectionHue,onError:S.error.bind(S),useFallback:h.isLiteVersionModeEnabled&&R,showVibeAnimationWithTransition:U,hideVibeAnimationWithTransition:w});A(t);let n=null===(i=C.entityMeta)||void 0===i?void 0:null===(e=i.trackParameters)||void 0===e?void 0:e.hue,o=I.collectionHue;return t.applySettings({hue:n,collectionHue:o}),()=>{t.destroy()}},[]),(0,a.useEffect)(()=>{var e,i,t,n,o,l;let a=null===(i=C.entityMeta)||void 0===i?void 0:null===(e=i.trackParameters)||void 0===e?void 0:e.hue,s=null===(n=C.entityMeta)||void 0===n?void 0:null===(t=n.trackParameters)||void 0===t?void 0:t.energy,r=null===(l=C.entityMeta)||void 0===l?void 0:null===(o=l.trackParameters)||void 0===o?void 0:o.userCollectionHue;r&&I.setUserCollectionHue(r),B?null==M||M.playAnimation({hue:a,collectionHue:r,energy:s}):null==M||M.idleAnimation()},[I,B,null===(t=C.entityMeta)||void 0===t?void 0:null===(i=t.trackParameters)||void 0===i?void 0:i.hue,null===(k=C.entityMeta)||void 0===k?void 0:null===(l=k.trackParameters)||void 0===l?void 0:l.energy,null===(f=C.entityMeta)||void 0===f?void 0:null===(_=f.trackParameters)||void 0===_?void 0:_.userCollectionHue,M]),(0,a.useEffect)(()=>{let e=j===m.Q2A.Dark?.0705:.9607;null==M||M.applySettings({backgroundColor:e})},[M,j]),(0,a.useEffect)(()=>{M&&(T?M.enableRender(v.nT.BLOCK_VISIBILITY):M.disableRender(v.nT.BLOCK_VISIBILITY))},[T,M]),x((0,a.useCallback)(()=>{null==M||M.likeAnimation()},[M])),(0,n.jsx)("div",{className:(0,o.W)(g().root,p),"data-intersection-property-id":N,ref:L,...(0,s.BA)(s.bG.vibeAnimation.VIBE_ANIMATION)})})},98863:function(e){e.exports={message:"NotificationLiteVersion_message__IT6FA",icon:"NotificationLiteVersion_icon__T4E8d",title:"NotificationLiteVersion_title__UPCcu",linkText:"NotificationLiteVersion_linkText__L6r3P",link:"NotificationLiteVersion_link__cQUUY"}},28020:function(e){e.exports={root:"VibeAnimation_root__UKMJy",root_visible:"VibeAnimation_root_visible__S7kXl"}}}]);